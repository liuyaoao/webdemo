<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>复杂网络图形工具Cytoscape.js</title>
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1">

 <script src="../../static/cytoscape.js"></script>

<!-- for testing with local version of cytoscape.js -->
<!--<script src="../cytoscape.js/build/cytoscape.js"></script>-->

<style>
  body {
    font-family: helvetica, sans-serif;
    font-size: 14px;
  }

  #cy {
    position: absolute;
    left: 0;
    top: 0;
    right: 0;
    bottom: 0;
    z-index: 999;
  }

  h1 {
    opacity: 0.5;
    font-size: 1em;
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function(){

    var cy = window.cy = cytoscape({
      container: document.getElementById('cy'),

      boxSelectionEnabled: false,
      autounselectify: true,
      layout: {
        name: 'grid',
        cols: 3
      },
      style: [
        {
          selector: 'node',
          style: {
            'height': 40,
            'width': 40,
            'background-color': '#ccc',
            'background-image':'./images/application.png',
            'selection-box-color':'#932',
            'background-fit':'cover',
            'label': 'data(label)'
          }
        },

        {
          selector: 'edge',
          style: {
            'label': 'data(label)',
            'width': 3,
            'line-color': '#ccc'
          }
        }],
        elements: [
          { data: { label: 'top left' }, classes: 'top-left' }
        ]


    });
    cy.on('tap', function(event){ //在整个图形上加个点击事件。
      // cyTarget holds a reference to the originator
      // of the event (core or element)
      var evtTarget = event.cyTarget;

      if( evtTarget === cy ){  //在画布上鼠标的点击位置加一个节点。
          console.log('tap on background',event);
          addOneNode(cy,{x:event.cyPosition.x,y:event.cyPosition.y});
      } else {
        console.log('tap on some element');
      }
    });
    cy.on('mouseover', 'node', function(evt){
      var node = evt.cyTarget;
      console.log( "mouse over event!!mouseover:" + node.id() );
    });
    cy.on('mouseout', 'node', function(evt){
      var node = evt.cyTarget;
      console.log( "mouse over event:" + node.id() );
    });





  });

  function addOneNode(cy,position){ //新增一个节点。
    cy.add({
        group: "nodes",
        data: { weight: 75,label:"helloworld" },
        position: { x: position.x, y: position.y }
    });
  }

</script>
</head>

<body>
<h1>Labels demo</h1>

<div id="cy"></div>

</body>
</html>
